<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/276742; Windows/6.1.7601 Service Pack 1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 12pt;
    }
  </style>
</head>
<body>
<a name="1784"/>

<div>
<span><div>1.要实现的功能</div><div style="margin-left:40px;">①显示员工信息列表</div><div style="margin-left:40px;">②显示添加员工信息表单页面：显示部门列表</div><div style="margin-left:40px;">③执行添加员工信息操作：执行完成之后显示员工列表页面</div><div style="margin-left:40px;">④执行删除员工信息操作：执行完成之后显示员工列表页面</div><div style="margin-left:40px;">⑤显示编辑员工信息表单页面：显示部门列表，要显示当前员工所属的部门</div><div style="margin-left:40px;">⑥执行更新员工信息操作：执行完成之后显示员工列表页面</div><div style="margin-left:40px;">⑦使用OpenSessionInViewFilter将Session开启的时间延长到JSP页面代码执行完</div><div style="margin-left:40px;">⑧针对部门列表使用Hibernate二级缓存</div><div>2.搭建SSH开发环境</div><div style="margin-left:40px;">①创建动态Web工程</div><div style="margin-left:40px;">②使用Spring整合Hibernate</div><div style="margin-left:80px;">[0]导入Spring和Hibernate以及连接数据库的JAR包</div><div style="margin-left:80px;">[1]准备外部的属性文件：jdbc.properties</div><div style="margin-left:80px;">[2]在Spring的配置文件中引入jdbc.properties</div><div style="margin-left:80px;">[3]配置数据源</div><div style="margin-left:80px;">[4]配置SessionFactory，装配数据源，指定cfg文件的位置</div><div style="margin-left:80px;">[5]配置事务管理器，装配SessionFactory</div><div style="margin-left:80px;">[6]开启基于注解的声明式事务，指定事务管理器的bean的id</div><div style="margin-left:80px;">[7]创建实体类并创建对应的hbm映射文件</div><div style="margin-left:80px;">[8]创建Dao类，注入SessionFactory</div><div style="margin-left:80px;">[9]在具体的Dao方法中，调用SessionFactory.getCurrentSession()从当前线程上获取Session对象</div><div style="margin-left:80px;">[10]创建Service类，注入Dao类的bean</div><div style="margin-left:80px;">[11]测试</div><div style="margin-left:40px;">③使用Spring整合Struts2</div><div style="margin-left:80px;">[1]导入Struts2需要的JAR包：注意要导入Struts2整合Spring需要的插件</div><div style="margin-left:80px;">[2]在web.xml文件中配置contextParam：目的是为Spring的ContextLoaderListener提供Spring配置文件的位置</div><div style="margin-left:80px;">[3]在web.xml文件中配置ContextLoaderListener：目的是在Web应用加载时创建IOC容器对象</div><div style="margin-left:80px;">[4]在web.xml文件中配置Struts2的核心Filter</div><div style="margin-left:80px;">[5]引入Struts2自身的配置文件</div><div style="margin-left:80px;">[6]创建Action类，并设置为多实例方式创建对象，注入Service类</div><div>4.创建源码包目录：创建Source Folder，用于专门保存配置文件，这个目录下的文件经过编译部署后会被保存到Web应用的类路径下面</div><div>5.显示部门名称</div><div style="margin-left:40px;">①迫切左外连接</div><table style="-evernote-table:true;border-collapse:collapse;width:100%;table-layout:fixed;margin-left:0px;"><tr><td style="border-style:solid;border-width:1px;border-color:rgb(211,211,211);padding:10px;margin:0px;width:100%;"><div align="left"><font color="#6A3E3E" face="Consolas" size="4"><span style="font-size:14pt; background:#e8f2fe">hql</span></font> <font face="Consolas" size="4"><span style="font-size:14pt; background:#e8f2fe">=</span></font> <font color="#2A00FF" face="Consolas" size="4"><span style="font-size:14pt; background:#e8f2fe">&quot;From Employee e LEFT JOIN FETCH e.department&quot;</span></font></div></td></tr></table><div style="margin-left:40px;">②使用OpenSessionInView</div><div style="margin-left:80px;">[1]默认情况下Session开启的状态是与事务方法基本一致的。当事务提交后，Session就会被关闭。如果页面上有延迟加载的属性，则会因为Session已经关闭而获取不到数据。</div><div style="margin-left:80px;">[2]OpenSessionInView可以将Session对象开启的时间延长到JSP页面代码执行完毕【视图渲染完毕】。</div><div style="margin-left:80px;">[3]OpenSessionInView是Spring提供的一个Filter，在web.xml中配置即可使用</div><table style="-evernote-table:true;border-collapse:collapse;width:100%;table-layout:fixed;margin-left:0px;"><tr><td style="border-style:solid;border-width:1px;border-color:rgb(211,211,211);padding:10px;margin:0px;width:100%;"><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">     </span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:14pt">&lt;</span></font><font color="#3F7F7F" face="Consolas" size="4"><span style="font-size:14pt">filter</span></font> <font color="#008080" face="Consolas" size="4"><span style="font-size:14pt">&gt;</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">          </span></font> <font color="#008080" face="Consolas" size="4"><span style="font-size:14pt">&lt;</span></font><font color="#3F7F7F" face="Consolas" size="4"><span style="font-size:14pt">filter-name</span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:14pt">&gt;</span></font> <font face="Consolas" size="4"><span style="font-size:14pt">OpenSessionInViewFilter</span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:14pt">&lt;/</span></font><font color="#3F7F7F" face="Consolas" size="4"><span style="font-size:14pt">filter-name</span></font> <font color="#008080" face="Consolas" size="4"><span style="font-size:14pt">&gt;</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">          </span></font> <font color="#008080" face="Consolas" size="4"><span style="font-size:14pt">&lt;</span></font><font color="#3F7F7F" face="Consolas" size="4"><span style="font-size:14pt">filter-class</span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:14pt">&gt;</span></font> <font face="Consolas" size="4"><span style="font-size:14pt">org.springframework.orm.hibernate4.support.OpenSessionInViewFilter</span></font> <font color="#008080" face="Consolas" size="4"><span style="font-size:14pt">&lt;/</span></font><font color="#3F7F7F" face="Consolas" size="4"><span style="font-size:14pt">filter-class</span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:14pt">&gt;</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">     </span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:14pt">&lt;/</span></font><font color="#3F7F7F" face="Consolas" size="4"><span style="font-size:14pt">filter</span></font> <font color="#008080" face="Consolas" size="4"><span style="font-size:14pt">&gt;</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">     </span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:14pt">&lt;</span></font><font color="#3F7F7F" face="Consolas" size="4"><span style="font-size:14pt">filter-mapping</span></font> <font color="#008080" face="Consolas" size="4"><span style="font-size:14pt">&gt;</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">          </span></font> <font color="#008080" face="Consolas" size="4"><span style="font-size:14pt">&lt;</span></font><font color="#3F7F7F" face="Consolas" size="4"><span style="font-size:14pt">filter-name</span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:14pt">&gt;</span></font> <font face="Consolas" size="4"><span style="font-size:14pt">OpenSessionInViewFilter</span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:14pt">&lt;/</span></font><font color="#3F7F7F" face="Consolas" size="4"><span style="font-size:14pt">filter-name</span></font> <font color="#008080" face="Consolas" size="4"><span style="font-size:14pt">&gt;</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">          </span></font> <font color="#008080" face="Consolas" size="4"><span style="font-size:14pt">&lt;</span></font><font color="#3F7F7F" face="Consolas" size="4"><span style="font-size:14pt">url-pattern</span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:14pt">&gt;</span></font> <font face="Consolas" size="4"><span style="font-size:14pt">/*</span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:14pt">&lt;/</span></font> <font color="#3F7F7F" face="Consolas" size="4"><span style="font-size:14pt">url-pattern</span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:14pt">&gt;</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">     </span></font><font color="#008080" face="Consolas" size="4"><span style="font-size:14pt">&lt;/</span></font><font color="#3F7F7F" face="Consolas" size="4"><span style="font-size:14pt">filter-mapping</span></font> <font color="#008080" face="Consolas" size="4"><span style="font-size:14pt">&gt;</span></font></div></td></tr></table><div style="margin-left:80px;">[4]注意：OpenSessionInViewFilter要求SessionFactory的bean的id是：sessionFactory</div><div>6.针对Department列表使用二级缓存</div><div style="margin-left:40px;">①导入EhCache的jar包</div><div style="margin-left:40px;">②引入EhCache的配置文件</div><div style="margin-left:40px;">③在cfg文件中开启二级缓存功能</div><div style="margin-left:40px;">④指定二级缓存产品</div><div style="margin-left:40px;">⑤开启查询缓存</div><div style="margin-left:40px;">⑥针对Department类开启二级缓存功能</div></span>
</div></body></html> 